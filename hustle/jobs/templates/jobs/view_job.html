{% extends "base.html" %}

{% block content %}

{% load crispy_forms_tags %}

<!--View Job-->
<head>
    <style>
    table {
      border-collapse: collapse;
    }

    tr {
      border-bottom: 1px solid #ddd;
    }
    </style>
    <title>View Job</title>
</head>
<div class="d-flex justify-content-center">
    <div class="card w-50 m-5">
        <div class="card-header">
            <h2>Job# {{ job.id }} <span style="float: right">Created By: {% include 'main/user_link.html' with user=job.customer %}</span></h2>
        </div>
        <div class="card-body justify-content-center">
            <p>Type: {{ job.type }}</p>
            <p>Accepted Bid: {{ job.accepted_bid.bid }}</p>
            <p>Time Estimate: {{ job.time_estimate }}</p>
            <p>Completion Window Start: {{ job.completion_window_start }}</p>
            <p>Completion Window End: {{ job.completion_window_end }}</p>
            <p>Completed: <input type="checkbox" disabled {% if job.complete %}checked{% endif %}></p>
            <p>Zip Code: {{ job.zip_code }}</p>
        </div>
        {% if not job.complete %}
            <div>
                <h5>Current Bids</h5>
            </div>
            <table class="table table-sm">
                <tr>
                    <th>Bid</th>
                    <th>User</th>
                </tr>
                {% for bid in bids %}
                    <tr>
                    <td>
                        {{ bid.bid }}
                    </td>
                    <td>
                        {{ bid.user }}
                    </td>
                    <td>
                        <a class="btn btn-secondary m-1" style="float: right" href="{{ url }}/jobs/view/{{ job.id }}">Accept</a>
                    </td>
                    </tr>
                {% endfor %}
            </table>
            <br>
            <div>
                <h5>Submit A New Bid</h5>
                <form method="POST">
                        {% csrf_token %}
                        <div class="fieldWrapper">
                            {{ job_bid_form.bid|as_crispy_field }}
                        </div>
                        <div class="justify-content-center">
                            <button class="btn btn-success" type="submit">Submit</button>
                        </div>
                </form>
            </div>
        {% endif %}
    </div>
</div>


{% endblock %}